{% extends "_page.html" %}

{% set _page = {
     "title": ('"' ~ search_text ~ '"')
   }
%}

{% set _navbar = {
     "search": true,
     "search_text": search_text
   }
%}

{% set _title = {} %}

{% if results|length > 0 %}
  {% set _title = _title|merge({ "results": results_count }) %}
{% endif %}

{% if download is defined %}
  {% set _title = _title|merge({ "download": download }) %}
{% endif %}

{% block content %}

<div class="sresults">

  {% if results|length > 0 %}
  <table class="table table-striped table-hover table-bordered">

    <!-- Table header -->
    <thead>
      <tr>
        <td>Protein</td>
        <td>Source</td>
        <td>Location</td>
        <td>pI</td>
      </tr>
    </thead>

    <!-- Table body -->
    <tbody>

      {% for result in results %}
      <!-- Search result-->
      <tr record-id="{{ result[0] }}">
	{% for value in result|slice(1) %}
	<td>{{ value }}</td>
	{% endfor %}
      </tr>
      {% endfor %}

    </tbody>
  </table>

  {% if pages is defined and pages|length > 1 %}
  <div class="row" style="margin-bottom: 20px;">
    <div class="col-lg-12">
      <div style="text-align: center;">
        <div class="btn-group" style="margin: 0 auto;">
          {% for page in pages %}
          {% if loop.index == current_page %}
          <a href="{{ page }}" type="button" class="btn btn-success disabled">
          {% else %}
          <a href="{{ page }}" type="button" class="btn btn-success">
          {% endif %}
            {{ loop.index }}
          </a>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  {% else %}
  <p class="lead">
    No results found.
  </p>
  {% endif %}

</div> <!-- /.sresults -->

{% endblock %}

{% block footer %}
<script>
  $(document).ready(function(){
    /*
     * Search results link to details page:
     */
    $('div.sresults table tbody tr').click(function(){
      window.location = '/r' + location.search + '&id=' + $(this).attr('record-id');
    });
  });
</script>
{% endblock %}
