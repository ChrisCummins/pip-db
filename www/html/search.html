{% extends "_page.html" %}

{% set _page = {
     "title": ('"' ~ search_text ~ '"')
   }
%}

{% set _navbar = {
     "search": true,
     "search_text": search_text
   }
%}

{% set _title = {} %}

{% if results|length > 0 %}
  {% set _title = _title|merge({ "results": results_count }) %}
{% endif %}

{% set _title = _title|merge({ "elapsed_time": elapsed_time }) %}

{% if download is defined %}
  {% set _title = _title|merge({ "download": download }) %}
{% endif %}



{% block content %}

<div class="sresults">

  {% if results|length > 0 %}
  <table class="table table-striped table-hover table-bordered">

    <!-- Table header -->
    <thead>
      <tr>
        <td><strong>Protein</strong></td>
        <td><strong>Source</strong></td>
        <td><strong>Location</strong></td>
        <td><strong>pI</strong></td>
      </tr>
    </thead>

    <!-- Table body -->
    <tbody>

      {% for result in results %}
      <!-- Search result-->
      <tr record-id="{{ result[0] }}">
	{% for value in result|slice(1) %}
	<td>{{ value }}</td>
	{% endfor %}
      </tr>
      {% endfor %}

    </tbody>
  </table>

  {% if pages is defined and pages|length > 1 %}
  <div class="row" style="margin-bottom: 20px;">
    <div class="col-lg-12">
      <div style="text-align: center;">
        <div class="btn-group" style="margin: 0 auto;">

          {% set pagination_first = pages|first %}
          {% set pagination_last = pages|last %}

          {% if pagination_first.num > first_page.num %}
          <a href="{{ first_page.href }}" type="button" class="btn btn-success">
            &laquo;
          </a>
          {% endif %}

          {% for page in pages %}
          {% if page.num == current_page.num %}
          <a href="{{ page.href }}" type="button" class="btn btn-success disabled">
          {% else %}
          <a href="{{ page.href }}" type="button" class="btn btn-success">
          {% endif %}
            {{ page.num }}
          </a>
          {% endfor %}

          {% if pagination_last.num < last_page.num %}
          <a href="{{ last_page.href }}" type="button" class="btn btn-success">
            &raquo;
          </a>
          {% endif %}

        </div>
      </div>
    </div>
  </div>
  {% endif %}

  {% else %}
  <p class="lead">
    No results found.
  </p>
  {% endif %}

</div> <!-- /.sresults -->

{% endblock %}

{% block footer %}
<script>
  $(document).ready(function(){
    /*
     * Search results link to details page:
     */
    $('div.sresults table tbody tr').click(function(){
      window.location = '{{ _links.results }}' + location.search + '&id=' + $(this).attr('record-id');
    });
  });
</script>
{% endblock %}
